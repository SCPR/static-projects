var jqueryNoConflict = jQuery;

//begin main function
jqueryNoConflict(document).ready(function(){
    //retriveData();
    renderDataVisualsTemplate(testData);

});

// grab data
function retriveData(){
    var dataSource = 'static-files/data/movie-award-winners.json';
    jqueryNoConflict.getJSON(dataSource, renderDataVisualsTemplate);
};

var testData = {"objects": [{"category": "Best Film", "prediction_source": "http://www.scpr.org/news/2013/02/13/35928/police-confirm-remains--burned-cabin-christopher-d/", "imdb_page": "http://www.imdb.com/", "awards_won": "L.A. Film Critics, London Film Critics", "nominee": "Amour", "movie": "Amour", "prediction": "This movie will win because I need to fill at least four lines of text?", "movie_image": "", "trailer": "http://www.imdb.com/rg/s/4/title/tt0944947/#lb-vi494708505"}, {"category": "Best Film", "prediction_source": "http://www.scpr.org/news/2013/02/13/35928/police-confirm-remains--burned-cabin-christopher-d/", "imdb_page": "http://www.imdb.com/", "awards_won": "Critics' Choice, Golden Globes, Screen Actors Guild, Baftas", "nominee": "Argo", "movie": "Argo", "prediction": "This movie will win because I need to fill at least four lines of text?", "movie_image": "", "trailer": "http://www.imdb.com/rg/s/4/title/tt0944947/#lb-vi494708505"}, {"category": "Best Film", "prediction_source": "http://www.scpr.org/news/2013/02/13/35928/police-confirm-remains--burned-cabin-christopher-d/", "imdb_page": "http://www.imdb.com/", "awards_won": "", "nominee": "Beasts of the Southern Wild", "movie": "Beasts of the Southern Wild", "prediction": "This movie will win because I need to fill at least four lines of text?", "movie_image": "", "trailer": "http://www.imdb.com/rg/s/4/title/tt0944947/#lb-vi494708505"}, {"category": "Best Film", "prediction_source": "http://www.scpr.org/news/2013/02/13/35928/police-confirm-remains--burned-cabin-christopher-d/", "imdb_page": "http://www.imdb.com/", "awards_won": "", "nominee": "Django Unchained", "movie": "Django Unchained", "prediction": "This movie will win because I need to fill at least four lines of text?", "movie_image": "", "trailer": "http://www.imdb.com/rg/s/4/title/tt0944947/#lb-vi494708505"}, {"category": "Best Film", "prediction_source": "http://www.scpr.org/news/2013/02/13/35928/police-confirm-remains--burned-cabin-christopher-d/", "imdb_page": "http://www.imdb.com/", "awards_won": "", "nominee": "Les Mis\u00e9rables", "movie": "Les Mis\u00e9rables", "prediction": "This movie will win because I need to fill at least four lines of text?", "movie_image": "", "trailer": "http://www.imdb.com/rg/s/4/title/tt0944947/#lb-vi494708505"}, {"category": "Best Film", "prediction_source": "http://www.scpr.org/news/2013/02/13/35928/police-confirm-remains--burned-cabin-christopher-d/", "imdb_page": "http://www.imdb.com/", "awards_won": "", "nominee": "Life of Pi", "movie": "Life of Pi", "prediction": "This movie will win because I need to fill at least four lines of text?", "movie_image": "", "trailer": "http://www.imdb.com/rg/s/4/title/tt0944947/#lb-vi494708505"}, {"category": "Best Film", "prediction_source": "http://www.scpr.org/news/2013/02/13/35928/police-confirm-remains--burned-cabin-christopher-d/", "imdb_page": "http://www.imdb.com/", "awards_won": "", "nominee": "Lincoln", "movie": "Lincoln", "prediction": "This movie will win because I need to fill at least four lines of text?", "movie_image": "", "trailer": "http://www.imdb.com/rg/s/4/title/tt0944947/#lb-vi494708505"}, {"category": "Best Film", "prediction_source": "http://www.scpr.org/news/2013/02/13/35928/police-confirm-remains--burned-cabin-christopher-d/", "imdb_page": "http://www.imdb.com/", "awards_won": "", "nominee": "Silver Linings Playbook", "movie": "Silver Linings Playbook", "prediction": "This movie will win because I need to fill at least four lines of text?", "movie_image": "", "trailer": "http://www.imdb.com/rg/s/4/title/tt0944947/#lb-vi494708505"}, {"category": "Best Film", "prediction_source": "http://www.scpr.org/news/2013/02/13/35928/police-confirm-remains--burned-cabin-christopher-d/", "imdb_page": "http://www.imdb.com/", "awards_won": "New York Film Critics", "nominee": "Zero Dark Thirty", "movie": "Zero Dark Thirty", "prediction": "This movie will win because I need to fill at least four lines of text?", "movie_image": "", "trailer": "http://www.imdb.com/rg/s/4/title/tt0944947/#lb-vi494708505"}, {"category": "Best Director", "prediction_source": "http://www.scpr.org/news/2013/02/13/35928/police-confirm-remains--burned-cabin-christopher-d/", "imdb_page": "http://www.imdb.com/", "awards_won": "European Film Awards", "nominee": "Michael Haneke", "movie": "Amour", "prediction": "This movie will win because I need to fill at least four lines of text?", "movie_image": "", "trailer": "http://www.imdb.com/rg/s/4/title/tt0944947/#lb-vi494708505"}, {"category": "Best Director", "prediction_source": "http://www.scpr.org/news/2013/02/13/35928/police-confirm-remains--burned-cabin-christopher-d/", "imdb_page": "http://www.imdb.com/", "awards_won": "", "nominee": "Beasts Benh Zeitlin", "movie": "Beasts of the Southern Wild", "prediction": "This movie will win because I need to fill at least four lines of text?", "movie_image": "", "trailer": "http://www.imdb.com/rg/s/4/title/tt0944947/#lb-vi494708505"}, {"category": "Best Director", "prediction_source": "http://www.scpr.org/news/2013/02/13/35928/police-confirm-remains--burned-cabin-christopher-d/", "imdb_page": "http://www.imdb.com/", "awards_won": "", "nominee": "Ang Lee", "movie": "Life of Pi", "prediction": "This movie will win because I need to fill at least four lines of text?", "movie_image": "", "trailer": "http://www.imdb.com/rg/s/4/title/tt0944947/#lb-vi494708505"}, {"category": "Best Director", "prediction_source": "http://www.scpr.org/news/2013/02/13/35928/police-confirm-remains--burned-cabin-christopher-d/", "imdb_page": "http://www.imdb.com/", "awards_won": "", "nominee": "David O. Russell", "movie": "Silver Linings Playbook", "prediction": "This movie will win because I need to fill at least four lines of text?", "movie_image": "", "trailer": "http://www.imdb.com/rg/s/4/title/tt0944947/#lb-vi494708505"}, {"category": "Best Director", "prediction_source": "http://www.scpr.org/news/2013/02/13/35928/police-confirm-remains--burned-cabin-christopher-d/", "imdb_page": "http://www.imdb.com/", "awards_won": "", "nominee": "Steven Spielberg", "movie": "Lincoln", "prediction": "This movie will win because I need to fill at least four lines of text?", "movie_image": "", "trailer": "http://www.imdb.com/rg/s/4/title/tt0944947/#lb-vi494708505"}, {"category": "Best Actor", "prediction_source": "http://www.scpr.org/news/2013/02/13/35928/police-confirm-remains--burned-cabin-christopher-d/", "imdb_page": "http://www.imdb.com/", "awards_won": "", "nominee": "Bradley Cooper", "movie": "Silver Linings Playbook", "prediction": "This movie will win because I need to fill at least four lines of text?", "movie_image": "", "trailer": "http://www.imdb.com/rg/s/4/title/tt0944947/#lb-vi494708505"}, {"category": "Best Actor", "prediction_source": "http://www.scpr.org/news/2013/02/13/35928/police-confirm-remains--burned-cabin-christopher-d/", "imdb_page": "http://www.imdb.com/", "awards_won": "New York Film Critics, Critics' Choice, Golden Globes, Screen Actors Guild, Baftas ", "nominee": "Daniel Day-Lewis", "movie": "Lincoln", "prediction": "This movie will win because I need to fill at least four lines of text?", "movie_image": "", "trailer": "http://www.imdb.com/rg/s/4/title/tt0944947/#lb-vi494708505"}, {"category": "Best Actor", "prediction_source": "http://www.scpr.org/news/2013/02/13/35928/police-confirm-remains--burned-cabin-christopher-d/", "imdb_page": "http://www.imdb.com/", "awards_won": "", "nominee": "Hugh Jackman", "movie": "Les Mis\u00e9rables", "prediction": "This movie will win because I need to fill at least four lines of text?", "movie_image": "", "trailer": "http://www.imdb.com/rg/s/4/title/tt0944947/#lb-vi494708505"}, {"category": "Best Actor", "prediction_source": "http://www.scpr.org/news/2013/02/13/35928/police-confirm-remains--burned-cabin-christopher-d/", "imdb_page": "http://www.imdb.com/", "awards_won": "L.A. Film Critics, London Film Critics", "nominee": "Joaquin Phoenix", "movie": "The Master", "prediction": "This movie will win because I need to fill at least four lines of text?", "movie_image": "", "trailer": "http://www.imdb.com/rg/s/4/title/tt0944947/#lb-vi494708505"}, {"category": "Best Actor", "prediction_source": "http://www.scpr.org/news/2013/02/13/35928/police-confirm-remains--burned-cabin-christopher-d/", "imdb_page": "http://www.imdb.com/", "awards_won": "", "nominee": "Denzel Washington", "movie": "Flight", "prediction": "This movie will win because I need to fill at least four lines of text?", "movie_image": "", "trailer": "http://www.imdb.com/rg/s/4/title/tt0944947/#lb-vi494708505"}, {"category": "Best Actress", "prediction_source": "http://www.scpr.org/news/2013/02/13/35928/police-confirm-remains--burned-cabin-christopher-d/", "imdb_page": "http://www.imdb.com/", "awards_won": "Critics' Choice, Golden Globes", "nominee": "Jessica Chastain", "movie": "Zero Dark Thirty", "prediction": "This movie will win because I need to fill at least four lines of text?", "movie_image": "", "trailer": "http://www.imdb.com/rg/s/4/title/tt0944947/#lb-vi494708505"}, {"category": "Best Actress", "prediction_source": "http://www.scpr.org/news/2013/02/13/35928/police-confirm-remains--burned-cabin-christopher-d/", "imdb_page": "http://www.imdb.com/", "awards_won": "L.A. Film Critics", "nominee": "Jennifer Lawrence", "movie": "Silver Linings Playbook", "prediction": "This movie will win because I need to fill at least four lines of text?", "movie_image": "", "trailer": "http://www.imdb.com/rg/s/4/title/tt0944947/#lb-vi494708505"}, {"category": "Best Actress", "prediction_source": "http://www.scpr.org/news/2013/02/13/35928/police-confirm-remains--burned-cabin-christopher-d/", "imdb_page": "http://www.imdb.com/", "awards_won": "L.A. Film Critics, European Film Awards, London Film Critics, Baftas", "nominee": "Emmanuelle Riva", "movie": "Amour", "prediction": "This movie will win because I need to fill at least four lines of text?", "movie_image": "", "trailer": "http://www.imdb.com/rg/s/4/title/tt0944947/#lb-vi494708505"}, {"category": "Best Actress", "prediction_source": "http://www.scpr.org/news/2013/02/13/35928/police-confirm-remains--burned-cabin-christopher-d/", "imdb_page": "http://www.imdb.com/", "awards_won": "", "nominee": "Quvenzhan\u00e9 Wallis", "movie": "Beasts of the Southern Wild", "prediction": "This movie will win because I need to fill at least four lines of text?", "movie_image": "", "trailer": "http://www.imdb.com/rg/s/4/title/tt0944947/#lb-vi494708505"}, {"category": "Best Actress", "prediction_source": "http://www.scpr.org/news/2013/02/13/35928/police-confirm-remains--burned-cabin-christopher-d/", "imdb_page": "http://www.imdb.com/", "awards_won": "", "nominee": "Naomi Watts", "movie": "The Impossible", "prediction": "This movie will win because I need to fill at least four lines of text?", "movie_image": "", "trailer": "http://www.imdb.com/rg/s/4/title/tt0944947/#lb-vi494708505"}]}

// render compiled handlebars template
function renderDataVisualsTemplate(testData){
    handlebarsDebugHelper();
    renderHandlebarsTemplate('static-files/templates/data-visuals.handlebars', '#data-visuals', testData);
};

// render handlebars templates via ajax
function getTemplateAjax(path, callback) {
    var source, template;
    jqueryNoConflict.ajax({
        url: path,
        success: function (data) {
            source = data;
            template = Handlebars.compile(source);
            if (callback) callback(template);
        }
    });
};

// function to compile handlebars template
function renderHandlebarsTemplate(withTemplate,inElement,withData){
    getTemplateAjax(withTemplate, function(template) {
        jqueryNoConflict(inElement).html(template(withData));
    })
};

// add handlebars debugger
function handlebarsDebugHelper(){
    Handlebars.registerHelper("debug", function(optionalValue) {
        console.log("Current Context");
        console.log("====================");
        console.log(this);
    });
};

// embed function
function embedBox() {
    var embed_url = 'http://projects.scpr.org/static/maps/flu-clinics/iframe.html';

    jAlert('<strong>To embed this visualization your blog or site, just copy this code:<br></strong>&lt;iframe src=\"'+ embed_url +'\" width=\"540px\" height=\"600px\" style=\"margin: 0 auto;\" scrolling=\"no\" frameborder=\"no\"&gt;&lt;/iframe>', 'Share or Embed');
};