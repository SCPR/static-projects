var jqueryNoConflict = jQuery;

// begin main function
jqueryNoConflict(document).ready(function() {

    seriesData = [
        {x: 883641600, y:273000},
        {x: 886320000, y:194000},
        {x: 888739200, y:146000},
        {x: 891417600, y:279000},
        {x: 894006000, y:400000},
        {x: 896684400, y:210000},
        {x: 899276400, y:120000},
        {x: 901954800, y:351000},
        {x: 904633200, y:219000},
        {x: 907225200, y:194000},
        {x: 909907200, y:281000},
        {x: 912499200, y:347000},
        {x: 915177600, y:123000},
        {x: 917856000, y:409000},
        {x: 920275200, y:108000},
        {x: 922953600, y:373000},
        {x: 925542000, y:213000},
        {x: 928220400, y:263000},
        {x: 930812400, y:293000},
        {x: 933490800, y:191000},
        {x: 936169200, y:203000},
        {x: 938761200, y:403000},
        {x: 941443200, y:291000},
        {x: 944035200, y:300000},
        {x: 946713600, y:233000},
        {x: 949392000, y:130000},
        {x: 951897600, y:471000},
        {x: 954576000, y:287000},
        {x: 957164400, y:225000},
        {x: 959842800, y:-46000},
        {x: 962434800, y:166000},
        {x: 965113200, y:2000},
        {x: 967791600, y:127000},
        {x: 970383600, y:-12000},
        {x: 973065600, y:223000},
        {x: 975657600, y:138000},
        {x: 978336000, y:-32000},
        {x: 981014400, y:69000},
        {x: 983433600, y:-29000},
        {x: 986112000, y:-281000},
        {x: 988700400, y:-41000},
        {x: 991378800, y:-126000},
        {x: 993970800, y:-122000},
        {x: 996649200, y:-156000},
        {x: 999327600, y:-244000},
        {x: 1001919600, y:-327000},
        {x: 1004601600, y:-296000},
        {x: 1007193600, y:-172000},
        {x: 1009872000, y:-143000},
        {x: 1012550400, y:-135000},
        {x: 1014969600, y:-22000},
        {x: 1017648000, y:-83000},
        {x: 1020236400, y:-6000},
        {x: 1022914800, y:52000},
        {x: 1025506800, y:-92000},
        {x: 1028185200, y:-14000},
        {x: 1030863600, y:-58000},
        {x: 1033455600, y:124000},
        {x: 1036137600, y:7000},
        {x: 1038729600, y:-162000},
        {x: 1041408000, y:89000},
        {x: 1044086400, y:-158000},
        {x: 1046505600, y:-215000},
        {x: 1049184000, y:-51000},
        {x: 1051772400, y:-10000},
        {x: 1054450800, y:-3000},
        {x: 1057042800, y:20000},
        {x: 1059721200, y:-44000},
        {x: 1062399600, y:105000},
        {x: 1064991600, y:197000},
        {x: 1067673600, y:13000},
        {x: 1070265600, y:119000},
        {x: 1072944000, y:159000},
        {x: 1075622400, y:43000},
        {x: 1078128000, y:333000},
        {x: 1080806400, y:247000},
        {x: 1083394800, y:306000},
        {x: 1086073200, y:78000},
        {x: 1088665200, y:37000},
        {x: 1091343600, y:125000},
        {x: 1094022000, y:155000},
        {x: 1096614000, y:343000},
        {x: 1099296000, y:65000},
        {x: 1101888000, y:128000},
        {x: 1104566400, y:130000},
        {x: 1107244800, y:240000},
        {x: 1109664000, y:135000},
        {x: 1112342400, y:362000},
        {x: 1114930800, y:168000},
        {x: 1117609200, y:246000},
        {x: 1120201200, y:372000},
        {x: 1122879600, y:192000},
        {x: 1125558000, y:65000},
        {x: 1128150000, y:81000},
        {x: 1130832000, y:335000},
        {x: 1133424000, y:158000},
        {x: 1136102400, y:274000},
        {x: 1138780800, y:316000},
        {x: 1141200000, y:280000},
        {x: 1143878400, y:181000},
        {x: 1146466800, y:21000},
        {x: 1149145200, y:80000},
        {x: 1151737200, y:210000},
        {x: 1154415600, y:179000},
        {x: 1157094000, y:159000},
        {x: 1159686000, y:-3000},
        {x: 1162368000, y:205000},
        {x: 1164960000, y:169000},
        {x: 1167638400, y:234000},
        {x: 1170316800, y:90000},
        {x: 1172736000, y:186000},
        {x: 1175410800, y:76000},
        {x: 1178002800, y:141000},
        {x: 1180681200, y:80000},
        {x: 1183273200, y:-35000},
        {x: 1185951600, y:-24000},
        {x: 1188630000, y:77000},
        {x: 1191222000, y:86000},
        {x: 1193900400, y:111000},
        {x: 1196496000, y:93000},
        {x: 1199174400, y:14000},
        {x: 1201852800, y:-85000},
        {x: 1204358400, y:-79000},
        {x: 1207033200, y:-215000},
        {x: 1209625200, y:-186000},
        {x: 1212303600, y:-169000},
        {x: 1214895600, y:-216000},
        {x: 1217574000, y:-270000},
        {x: 1220252400, y:-459000},
        {x: 1222844400, y:-472000},
        {x: 1225522800, y:-775000},
        {x: 1228118400, y:-705000},
        {x: 1230796800, y:-794000},
        {x: 1233475200, y:-695000},
        {x: 1235894400, y:-830000},
        {x: 1238569200, y:-704000},
        {x: 1241161200, y:-352000},
        {x: 1243839600, y:-472000},
        {x: 1246431600, y:-351000},
        {x: 1249110000, y:-210000},
        {x: 1251788400, y:-233000},
        {x: 1254380400, y:-170000},
        {x: 1257058800, y:-21000},
        {x: 1259654400, y:-220000},
        {x: 1262332800, y:-13000},
        {x: 1265011200, y:-40000},
        {x: 1267430400, y:154000},
        {x: 1270105200, y:229000},
        {x: 1272697200, y:521000},
        {x: 1275375600, y:-130000},
        {x: 1277967600, y:-86000},
        {x: 1280646000, y:-37000},
        {x: 1283324400, y:-43000},
        {x: 1285916400, y:228000},
        {x: 1288594800, y:144000},
        {x: 1291190400, y:95000},
        {x: 1293868800, y:69000},
        {x: 1296547200, y:196000},
        {x: 1298966400, y:205000},
        {x: 1301641200, y:304000},
        {x: 1304233200, y:115000},
        {x: 1306911600, y:209000},
        {x: 1309503600, y:78000},
        {x: 1312182000, y:132000},
        {x: 1314860400, y:225000},
        {x: 1317452400, y:166000},
        {x: 1320130800, y:174000},
        {x: 1322726400, y:230000},
        {x: 1325404800, y:311000},
        {x: 1328083200, y:271000},
        {x: 1330588800, y:205000},
        {x: 1333263600, y:112000},
        {x: 1335855600, y:125000},
        {x: 1338534000, y:87000},
        {x: 1341126000, y:153000},
        {x: 1343804400, y:165000},
        {x: 1346482800, y:138000},
        {x: 1349074800, y:160000},
        {x: 1351753200, y:247000},
        {x: 1354348800, y:219000},
        {x: 1357027200, y:148000},
        {x: 1359705600, y:332000},
        {x: 1362124800, y:142000},
        {x: 1364799600, y:199000},
        {x: 1367391600, y:176000},
    ]

    var graph = new Rickshaw.Graph( {
    	element: document.getElementById("chart"),
    	renderer: 'bar',
    	width: 1200,
    	height: 500,
    	min: 'auto',
    	series: [{
            name: 'Jobs Added',
            data: seriesData,
    			color: 'blue',
    		}
    	]
    } );

    var slider = new Rickshaw.Graph.RangeSlider({
    	graph: graph,
    	element: jqueryNoConflict('#slider')
    });

    //var x_axis = new Rickshaw.Graph.Axis.Time({
        //graph: graph,
        //timeUnit: (new Rickshaw.Fixtures.Time()).unit('month')
    //});

    var y_axis = new Rickshaw.Graph.Axis.Y( {
        graph: graph,
        orientation: 'left',
        tickFormat: Rickshaw.Fixtures.Number.formatKMBT,
        element: document.getElementById("y_axis"),
    });

    var hoverDetail = new Rickshaw.Graph.HoverDetail({
    	graph: graph,
        formatter: function(series, x, y) {
            var dateFormat = 'MMMM YYYY';
            var dateOutput = moment(new Date(x * 1000)).format(dateFormat);
            var date = '<span class="date">' + dateOutput + '</span>';
            var swatch = '<span class="detail_swatch" style="background-color: ' + series.color + '"></span>';
            var content = swatch + series.name + ": " + parseInt(y) + '<br>' + date;
            return content;
        }
    });

    var annotator = new Rickshaw.Graph.Annotate({
        graph: graph,
        element: document.getElementById('timeline')
    });

    annotator.add(seriesData[1].x, 'First jobs report after the 105th Congress begins its session');
    annotator.add(seriesData[45].x, 'First jobs report following the Sept. 11 terrorist attacks.');
    annotator.add(seriesData[129].x, 'First jobs report following Lehman Bros. filing for Chapter 11 bankruptcy.');

    graph.render();


    /*
    var resize = function() {
        var padding = -150;
        graph.configure({
            width: window.innerWidth - padding,
            height: window.innerHeight - padding
        });
        graph.render();
    }

    window.addEventListener('resize', resize);
    resize();
    */

});