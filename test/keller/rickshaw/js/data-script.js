var jqueryNoConflict = jQuery;

// begin main function
jqueryNoConflict(document).ready(function() {

    var jobs_added = [
        {x: 1041408000, y:89000},
        {x: 1044086400, y:-158000},
        {x: 1046505600, y:-215000},
        {x: 1049184000, y:-51000},
        {x: 1051772400, y:-10000},
        {x: 1054450800, y:-3000},
        {x: 1057042800, y:20000},
        {x: 1059721200, y:-44000},
        {x: 1062399600, y:105000},
        {x: 1064991600, y:197000},
        {x: 1067673600, y:13000},
        {x: 1070265600, y:119000},
        {x: 1072944000, y:159000},
        {x: 1075622400, y:43000},
        {x: 1078128000, y:333000},
        {x: 1080806400, y:247000},
        {x: 1083394800, y:306000},
        {x: 1086073200, y:78000},
        {x: 1088665200, y:37000},
        {x: 1091343600, y:125000},
        {x: 1094022000, y:155000},
        {x: 1096614000, y:343000},
        {x: 1099296000, y:65000},
        {x: 1101888000, y:128000},
        {x: 1104566400, y:130000},
        {x: 1107244800, y:240000},
        {x: 1109664000, y:135000},
        {x: 1112342400, y:362000},
        {x: 1114930800, y:168000},
        {x: 1117609200, y:246000},
        {x: 1120201200, y:372000},
        {x: 1122879600, y:192000},
        {x: 1125558000, y:65000},
        {x: 1128150000, y:81000},
        {x: 1130832000, y:335000},
        {x: 1133424000, y:158000},
        {x: 1136102400, y:274000},
        {x: 1138780800, y:316000},
        {x: 1141200000, y:280000},
        {x: 1143878400, y:181000},
        {x: 1146466800, y:21000},
        {x: 1149145200, y:80000},
        {x: 1151737200, y:210000},
        {x: 1154415600, y:179000},
        {x: 1157094000, y:159000},
        {x: 1159686000, y:-3000},
        {x: 1162368000, y:205000},
        {x: 1164960000, y:169000},
        {x: 1167638400, y:234000},
        {x: 1170316800, y:90000},
        {x: 1172736000, y:186000},
        {x: 1175410800, y:76000},
        {x: 1178002800, y:141000},
        {x: 1180681200, y:80000},
        {x: 1183273200, y:-35000},
        {x: 1185951600, y:-24000},
        {x: 1188630000, y:77000},
        {x: 1191222000, y:86000},
        {x: 1193900400, y:111000},
        {x: 1196496000, y:93000},
        {x: 1199174400, y:14000},
        {x: 1201852800, y:-85000},
        {x: 1204358400, y:-79000},
        {x: 1207033200, y:-215000},
        {x: 1209625200, y:-186000},
        {x: 1212303600, y:-169000},
        {x: 1214895600, y:-216000},
        {x: 1217574000, y:-270000},
        {x: 1220252400, y:-459000},
        {x: 1222844400, y:-472000},
        {x: 1225522800, y:-775000},
        {x: 1228118400, y:-705000},
        {x: 1230796800, y:-794000},
        {x: 1233475200, y:-695000},
        {x: 1235894400, y:-830000},
        {x: 1238569200, y:-704000},
        {x: 1241161200, y:-352000},
        {x: 1243839600, y:-472000},
        {x: 1246431600, y:-351000},
        {x: 1249110000, y:-210000},
        {x: 1251788400, y:-233000},
        {x: 1254380400, y:-170000},
        {x: 1257058800, y:-21000},
        {x: 1259654400, y:-220000},
        {x: 1262332800, y:-13000},
        {x: 1265011200, y:-40000},
        {x: 1267430400, y:154000},
        {x: 1270105200, y:229000},
        {x: 1272697200, y:521000},
        {x: 1275375600, y:-130000},
        {x: 1277967600, y:-86000},
        {x: 1280646000, y:-37000},
        {x: 1283324400, y:-43000},
        {x: 1285916400, y:228000},
        {x: 1288594800, y:144000},
        {x: 1291190400, y:95000},
        {x: 1293868800, y:69000},
        {x: 1296547200, y:196000},
        {x: 1298966400, y:205000},
        {x: 1301641200, y:304000},
        {x: 1304233200, y:115000},
        {x: 1306911600, y:209000},
        {x: 1309503600, y:78000},
        {x: 1312182000, y:132000},
        {x: 1314860400, y:225000},
        {x: 1317452400, y:166000},
        {x: 1320130800, y:174000},
        {x: 1322726400, y:230000},
        {x: 1325404800, y:311000},
        {x: 1328083200, y:271000},
        {x: 1330588800, y:205000},
        {x: 1333263600, y:112000},
        {x: 1335855600, y:125000},
        {x: 1338534000, y:87000},
        {x: 1341126000, y:153000},
        {x: 1343804400, y:165000},
        {x: 1346482800, y:138000},
        {x: 1349074800, y:160000},
        {x: 1351753200, y:247000},
        {x: 1354348800, y:219000},
        {x: 1357027200, y:148000},
        {x: 1359705600, y:332000},
        {x: 1362124800, y:142000},
        {x: 1364799600, y:199000},
        {x: 1367391600, y:176000},
    ];

    var initial_unemployment_claims = [
        {x: 1041408000, y:302588},
        {x: 1044086400, y:247636},
        {x: 1046505600, y:234667},
        {x: 1049184000, y:276561},
        {x: 1051772400, y:234383},
        {x: 1054450800, y:243902},
        {x: 1057042800, y:265443},
        {x: 1059721200, y:206708},
        {x: 1062399600, y:214184},
        {x: 1064991600, y:270168},
        {x: 1067673600, y:220988},
        {x: 1070265600, y:237389},
        {x: 1072944000, y:238913},
        {x: 1075622400, y:212921},
        {x: 1078128000, y:212986},
        {x: 1080806400, y:219127},
        {x: 1083394800, y:175135},
        {x: 1086073200, y:212211},
        {x: 1088665200, y:201957},
        {x: 1091343600, y:180898},
        {x: 1094022000, y:177124},
        {x: 1096614000, y:195495},
        {x: 1099296000, y:211673},
        {x: 1101888000, y:225503},
        {x: 1104566400, y:232040},
        {x: 1107244800, y:192678},
        {x: 1109664000, y:197999},
        {x: 1112342400, y:190003},
        {x: 1114930800, y:168682},
        {x: 1117609200, y:182042},
        {x: 1120201200, y:163532},
        {x: 1122879600, y:163337},
        {x: 1125558000, y:154040},
        {x: 1128150000, y:161013},
        {x: 1130832000, y:179593},
        {x: 1133424000, y:187582},
        {x: 1136102400, y:203306},
        {x: 1138780800, y:160137},
        {x: 1141200000, y:186512},
        {x: 1143878400, y:177745},
        {x: 1146466800, y:174640},
        {x: 1149145200, y:174839},
        {x: 1151737200, y:169519},
        {x: 1154415600, y:171236},
        {x: 1157094000, y:148617},
        {x: 1159686000, y:177365},
        {x: 1162368000, y:194699},
        {x: 1164960000, y:196954},
        {x: 1167638400, y:222940},
        {x: 1170316800, y:178323},
        {x: 1172736000, y:182477},
        {x: 1175410800, y:186152},
        {x: 1178002800, y:184060},
        {x: 1180681200, y:185261},
        {x: 1183273200, y:189336},
        {x: 1185951600, y:184416},
        {x: 1188630000, y:155790},
        {x: 1191222000, y:216791},
        {x: 1193900400, y:219151},
        {x: 1196496000, y:214371},
        {x: 1199174400, y:261961},
        {x: 1201852800, y:213591},
        {x: 1204358400, y:201504},
        {x: 1207033200, y:236112},
        {x: 1209625200, y:204436},
        {x: 1212303600, y:223559},
        {x: 1214895600, y:266931},
        {x: 1217574000, y:227653},
        {x: 1220252400, y:224953},
        {x: 1222844400, y:289594},
        {x: 1225522800, y:292913},
        {x: 1228118400, y:356558},
        {x: 1230796800, y:261961},
        {x: 1233475200, y:213591},
        {x: 1235894400, y:201504},
        {x: 1238569200, y:236112},
        {x: 1241161200, y:204436},
        {x: 1243839600, y:223559},
        {x: 1246431600, y:266931},
        {x: 1249110000, y:227653},
        {x: 1251788400, y:224953},
        {x: 1254380400, y:289594},
        {x: 1257058800, y:292913},
        {x: 1259654400, y:356558},
        {x: 1262332800, y:375795},
        {x: 1265011200, y:298478},
        {x: 1267430400, y:320885},
        {x: 1270105200, y:349026},
        {x: 1272697200, y:291288},
        {x: 1275375600, y:339478},
        {x: 1277967600, y:339181},
        {x: 1280646000, y:293979},
        {x: 1283324400, y:285991},
        {x: 1285916400, y:287643},
        {x: 1288594800, y:305008},
        {x: 1291190400, y:355398},
        {x: 1293868800, y:315606},
        {x: 1296547200, y:263505},
        {x: 1298966400, y:285902},
        {x: 1301641200, y:283730},
        {x: 1304233200, y:258060},
        {x: 1306911600, y:314735},
        {x: 1309503600, y:273249},
        {x: 1312182000, y:262376},
        {x: 1314860400, y:239485},
        {x: 1317452400, y:267980},
        {x: 1320130800, y:278977},
        {x: 1322726400, y:281142},
        {x: 1325404800, y:305011},
        {x: 1328083200, y:254961},
        {x: 1330588800, y:238149},
        {x: 1333263600, y:252699},
        {x: 1335855600, y:254830},
        {x: 1338534000, y:268326},
        {x: 1341126000, y:258130},
        {x: 1343804400, y:244177},
        {x: 1346482800, y:200592},
        {x: 1349074800, y:255021},
        {x: 1351753200, y:241371},
        {x: 1354348800, y:242431},
        {x: 1357027200, y:290008},
        {x: 1359705600, y:234183},
        {x: 1362124800, y:219763},
        {x: 1364799600, y:225171},
        {x: 1367391600, y:235240},
    ];

    var median_housing_price = [
        {x: 1041408000, y:283000},
        {x: 1044086400, y:292000},
        {x: 1046505600, y:301000},
        {x: 1049184000, y:307000},
        {x: 1051772400, y:312000},
        {x: 1054450800, y:321000},
        {x: 1057042800, y:328000},
        {x: 1059721200, y:338000},
        {x: 1062399600, y:335000},
        {x: 1064991600, y:333000},
        {x: 1067673600, y:336000},
        {x: 1070265600, y:346000},
        {x: 1072944000, y:343000},
        {x: 1075622400, y:351000},
        {x: 1078128000, y:371000},
        {x: 1080806400, y:386000},
        {x: 1083394800, y:396000},
        {x: 1086073200, y:406000},
        {x: 1088665200, y:402000},
        {x: 1091343600, y:407000},
        {x: 1094022000, y:409000},
        {x: 1096614000, y:410000},
        {x: 1099296000, y:415000},
        {x: 1101888000, y:424000},
        {x: 1104566400, y:415000},
        {x: 1107244800, y:425000},
        {x: 1109664000, y:439000},
        {x: 1112342400, y:445000},
        {x: 1114930800, y:456000},
        {x: 1117609200, y:465000},
        {x: 1120201200, y:469000},
        {x: 1122879600, y:476000},
        {x: 1125558000, y:475000},
        {x: 1128150000, y:473000},
        {x: 1130832000, y:479000},
        {x: 1133424000, y:479000},
        {x: 1136102400, y:469000},
        {x: 1138780800, y:480000},
        {x: 1141200000, y:501000},
        {x: 1143878400, y:485000},
        {x: 1146466800, y:485000},
        {x: 1149145200, y:493000},
        {x: 1151737200, y:489000},
        {x: 1154415600, y:489000},
        {x: 1157094000, y:484000},
        {x: 1159686000, y:484000},
        {x: 1162368000, y:487000},
        {x: 1164960000, y:495000},
        {x: 1167638400, y:485000},
        {x: 1170316800, y:495000},
        {x: 1172736000, y:505000},
        {x: 1175410800, y:505000},
        {x: 1178002800, y:505000},
        {x: 1180681200, y:502000},
        {x: 1183273200, y:505000},
        {x: 1185951600, y:500000},
        {x: 1188630000, y:462000},
        {x: 1191222000, y:444000},
        {x: 1193900400, y:435000},
        {x: 1196496000, y:425000},
        {x: 1199174400, y:415000},
        {x: 1201852800, y:408000},
        {x: 1204358400, y:385000},
        {x: 1207033200, y:385000},
        {x: 1209625200, y:370000},
        {x: 1212303600, y:355000},
        {x: 1214895600, y:348000},
        {x: 1217574000, y:330000},
        {x: 1220252400, y:308500},
        {x: 1222844400, y:300000},
        {x: 1225522800, y:285000},
        {x: 1228118400, y:278000},
        {x: 1230796800, y:250000},
        {x: 1233475200, y:250000},
        {x: 1235894400, y:250000},
        {x: 1238569200, y:247000},
        {x: 1241161200, y:249000},
        {x: 1243839600, y:265000},
        {x: 1246431600, y:268000},
        {x: 1249110000, y:275000},
        {x: 1251788400, y:275000},
        {x: 1254380400, y:280000},
        {x: 1257058800, y:285000},
        {x: 1259654400, y:289000},
        {x: 1262332800, y:271500},
        {x: 1265011200, y:275000},
        {x: 1267430400, y:285000},
        {x: 1270105200, y:285000},
        {x: 1272697200, y:305000},
        {x: 1275375600, y:300000},
        {x: 1277967600, y:295000},
        {x: 1280646000, y:288000},
        {x: 1283324400, y:295500},
        {x: 1285916400, y:283000},
        {x: 1288594800, y:287000},
        {x: 1291190400, y:290000},
        {x: 1293868800, y:270000},
        {x: 1296547200, y:275000},
        {x: 1298966400, y:280500},
        {x: 1301641200, y:280000},
        {x: 1304233200, y:280000},
        {x: 1306911600, y:285000},
        {x: 1309503600, y:283000},
        {x: 1312182000, y:279000},
        {x: 1314860400, y:280000},
        {x: 1317452400, y:270000},
        {x: 1320130800, y:275000},
        {x: 1322726400, y:270000},
        {x: 1325404800, y:260000},
        {x: 1328083200, y:264750},
        {x: 1330588800, y:280000},
        {x: 1333263600, y:290000},
        {x: 1335855600, y:295000},
        {x: 1338534000, y:300000},
        {x: 1341126000, y:306000},
        {x: 1343804400, y:309000},
        {x: 1346482800, y:315000},
        {x: 1349074800, y:315000},
        {x: 1351753200, y:321000},
        {x: 1354348800, y:323000},
        {x: 1357027200, y:321000},
        {x: 1359705600, y:320000},
        {x: 1362124800, y:345500},
        {x: 1364799600, y:357000},
        {x: 1367391600, y:357000},
    ];

    var unemployment_rate = [
        {x: 1041408000, y:7},
        {x: 1044086400, y:6.9},
        {x: 1046505600, y:6.6},
        {x: 1049184000, y:6.5},
        {x: 1051772400, y:6.7},
        {x: 1054450800, y:7.4},
        {x: 1057042800, y:7.7},
        {x: 1059721200, y:7.4},
        {x: 1062399600, y:7.1},
        {x: 1064991600, y:7},
        {x: 1067673600, y:6.8},
        {x: 1070265600, y:6.3},
        {x: 1072944000, y:6.9},
        {x: 1075622400, y:6.6},
        {x: 1078128000, y:6.8},
        {x: 1080806400, y:6.5},
        {x: 1083394800, y:6.5},
        {x: 1086073200, y:6.9},
        {x: 1088665200, y:7.1},
        {x: 1091343600, y:6.6},
        {x: 1094022000, y:6.3},
        {x: 1096614000, y:6.2},
        {x: 1099296000, y:6.1},
        {x: 1101888000, y:5.8},
        {x: 1104566400, y:6.1},
        {x: 1107244800, y:6},
        {x: 1109664000, y:5.6},
        {x: 1112342400, y:5.3},
        {x: 1114930800, y:5.3},
        {x: 1117609200, y:5.3},
        {x: 1120201200, y:5.6},
        {x: 1122879600, y:5.1},
        {x: 1125558000, y:5},
        {x: 1128150000, y:4.9},
        {x: 1130832000, y:5.2},
        {x: 1133424000, y:5},
        {x: 1136102400, y:5.3},
        {x: 1138780800, y:5.2},
        {x: 1141200000, y:4.7},
        {x: 1143878400, y:4.6},
        {x: 1146466800, y:4.7},
        {x: 1149145200, y:4.7},
        {x: 1151737200, y:5.4},
        {x: 1154415600, y:5.1},
        {x: 1157094000, y:4.7},
        {x: 1159686000, y:4.4},
        {x: 1162368000, y:4.4},
        {x: 1164960000, y:4.3},
        {x: 1167638400, y:5.1},
        {x: 1170316800, y:4.8},
        {x: 1172736000, y:4.8},
        {x: 1175410800, y:4.6},
        {x: 1178002800, y:4.5},
        {x: 1180681200, y:4.9},
        {x: 1183273200, y:5.6},
        {x: 1185951600, y:5.3},
        {x: 1188630000, y:5.3},
        {x: 1191222000, y:5.2},
        {x: 1193900400, y:5.2},
        {x: 1196496000, y:5.5},
        {x: 1199174400, y:6.2},
        {x: 1201852800, y:5.8},
        {x: 1204358400, y:6.2},
        {x: 1207033200, y:5.9},
        {x: 1209625200, y:6.7},
        {x: 1212303600, y:7.2},
        {x: 1214895600, y:8.2},
        {x: 1217574000, y:8.4},
        {x: 1220252400, y:8.2},
        {x: 1222844400, y:8.5},
        {x: 1225522800, y:8.8},
        {x: 1228118400, y:9.5},
        {x: 1230796800, y:10.6},
        {x: 1233475200, y:10.8},
        {x: 1235894400, y:11},
        {x: 1238569200, y:10.6},
        {x: 1241161200, y:11.2},
        {x: 1243839600, y:11.7},
        {x: 1246431600, y:12.5},
        {x: 1249110000, y:12.4},
        {x: 1251788400, y:12.2},
        {x: 1254380400, y:12.1},
        {x: 1257058800, y:11.8},
        {x: 1259654400, y:11.9},
        {x: 1262332800, y:12.8},
        {x: 1265011200, y:12.5},
        {x: 1267430400, y:12.5},
        {x: 1270105200, y:12.1},
        {x: 1272697200, y:12.2},
        {x: 1275375600, y:12.4},
        {x: 1277967600, y:13.3},
        {x: 1280646000, y:13.1},
        {x: 1283324400, y:12.6},
        {x: 1285916400, y:12.5},
        {x: 1288594800, y:12.7},
        {x: 1291190400, y:12.4},
        {x: 1293868800, y:12.8},
        {x: 1296547200, y:12.3},
        {x: 1298966400, y:12.1},
        {x: 1301641200, y:11.7},
        {x: 1304233200, y:12},
        {x: 1306911600, y:12.5},
        {x: 1309503600, y:13.2},
        {x: 1312182000, y:12.9},
        {x: 1314860400, y:12.5},
        {x: 1317452400, y:12.1},
        {x: 1320130800, y:11.6},
        {x: 1322726400, y:11.6},
        {x: 1325404800, y:11.9},
        {x: 1328083200, y:11.6},
        {x: 1330588800, y:11.2},
        {x: 1333263600, y:10.6},
        {x: 1335855600, y:10.8},
        {x: 1338534000, y:11.1},
        {x: 1341126000, y:11.9},
        {x: 1343804400, y:11.3},
        {x: 1346482800, y:10.4},
        {x: 1349074800, y:10.4},
        {x: 1351753200, y:10},
        {x: 1354348800, y:10.2},
        {x: 1357027200, y:10.9},
        {x: 1359705600, y:10.3},
        {x: 1362124800, y:9.9},
        {x: 1364799600, y:9.3},
        {x: 1367391600, y:9.2},
    ];






    var graph = new Rickshaw.Graph( {
    	element: document.getElementById("chart"),
    	renderer: 'line',
    	width: 1200,
    	height: 500,
    	min: 'auto',
    	series: [{
                name: 'Jobs Added',
                data: jobs_added,
                color: 'steelblue'
    		},{
                name: 'initial_unemployment_claims',
                data: initial_unemployment_claims,
    			color: 'lightblue'
    		},{
                name: 'median_housing_price',
                data: median_housing_price,
                color: 'red'
    		},{
                name: 'unemployment_rate',
                data: unemployment_rate,
                color: 'green'
    		}
    	]
    } );

    var slider = new Rickshaw.Graph.RangeSlider({
    	graph: graph,
    	element: jqueryNoConflict('#slider')
    });

    //var x_axis = new Rickshaw.Graph.Axis.Time({
        //graph: graph,
        //timeUnit: (new Rickshaw.Fixtures.Time()).unit('month')
    //});

    var y_axis = new Rickshaw.Graph.Axis.Y( {
        graph: graph,
        orientation: 'left',
        tickFormat: Rickshaw.Fixtures.Number.formatKMBT,
        element: document.getElementById("y_axis"),
    });

    var hoverDetail = new Rickshaw.Graph.HoverDetail({
    	graph: graph,
        formatter: function(series, x, y) {
            var dateFormat = 'MMMM YYYY';
            var dateOutput = moment(new Date(x * 1000)).format(dateFormat);
            var date = '<span class="date">' + dateOutput + '</span>';
            var swatch = '<span class="detail_swatch" style="background-color: ' + series.color + '"></span>';
            var content = swatch + series.name + ": " + parseInt(y) + '<br>' + date;
            return content;
        }
    });

    var annotator = new Rickshaw.Graph.Annotate({
        graph: graph,
        element: document.getElementById('timeline')
    });

    annotator.add(jobs_added[69].x, 'First reports following Lehman Brothers bankruptcy');
    //annotator.add(seriesData[45].x, 'First jobs report following the Sept. 11 terrorist attacks.');
    //annotator.add(seriesData[129].x, 'First jobs report following Lehman Bros. filing for Chapter 11 bankruptcy.');

    graph.render();


    var legend = new Rickshaw.Graph.Legend({
        graph: graph,
        element: document.getElementById('legend')
    });

    var shelving = new Rickshaw.Graph.Behavior.Series.Toggle({
        graph: graph,
        legend: legend
    });

    var order = new Rickshaw.Graph.Behavior.Series.Order({
        graph: graph,
        legend: legend
    });

    var highlight = new Rickshaw.Graph.Behavior.Series.Highlight({
        graph: graph,
        legend: legend
    });



    /*
    var resize = function() {
        var padding = -150;
        graph.configure({
            width: window.innerWidth - padding,
            height: window.innerHeight - padding
        });
        graph.render();
    }

    window.addEventListener('resize', resize);
    resize();
    */

});