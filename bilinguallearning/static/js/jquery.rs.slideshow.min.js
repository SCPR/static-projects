(function(b){var a={init:function(d){return this.each(function(){var f=this,e=b(this),h=e.data("rsf_slideshow"),g;if(!h){g=b.extend(true,{},b.rsfSlideshow.defaults);if(typeof d==="object"){b.extend(true,g,d)}e.data("rsf_slideshow",{slides:[],this_slide:0,effect_iterator:{this_effect:-1,direction:1},settings:g,interval_id:false,loaded_imgs:[],queued:0});h=e.data("rsf_slideshow")}g=h.settings;e.rsfSlideshow("getSlidesFromMarkup");if(g.slides.length){e.rsfSlideshow("addSlides",g.slides);g.slides=[]}if(typeof g.eventHandlers==="object"){b.each(g.eventHandlers,function(j,i){e.bind(j,function(k){i(e,k)})})}if(g.controls.playPause.auto){e.rsfSlideshow("addControl","playPause")}if(g.controls.previousSlide.auto){e.rsfSlideshow("addControl","previousSlide")}if(g.controls.index.auto){e.rsfSlideshow("addControl","index")}if(g.controls.nextSlide.auto){e.rsfSlideshow("addControl","nextSlide")}if(g.autostart){e.rsfSlideshow("startShow")}})},addSlides:function(d){return this.each(function(){if(d instanceof Array){for(var f=0,e=d.length;f<e;f++){c._addSlide(b(this),d[f])}}else{c._addSlide(b(this),d)}})},removeSlides:function(d){if(d===undefined){return this.each(function(){b(this).data("rsf_slideshow").slides=[]})}else{if(d instanceof Array){d.sort(function(g,f){return f-g});var e=[];return this.each(function(){for(var g=0,f=d.length;g<f;g++){if(b.inArray(d[g],e)===-1){c._removeSlide(b(this),d[g]);e.push(d[g])}}})}else{return this.each(function(){c._removeSlide(b(this),d)})}}},getSlideData:function(d){if(d===undefined){return this.data("rsf_slideshow").slides}if(this.data("rsf_slideshow").slides[d]){return this.data("rsf_slideshow").slides[d]}return false},startShow:function(d,e){return this.each(function(){var f=b(this);if(!f.data("rsf_slideshow").interval_id){if(e){f.rsfSlideshow("nextSlide")}f.data("rsf_slideshow")._current_interval=d;c._setTimeout(f,d);f.bind("_rsSlideReady",function(h,g){c._setTimeout(f,d)});c._trigger(f,"rsStartShow")}})},stopShow:function(){return this.each(function(){var d=b(this),e=d.data("rsf_slideshow");if(e.interval_id){clearTimeout(e.interval_id);e.interval_id=false}d.unbind("_rsSlideReady");c._trigger(b(this),"rsStopShow")})},toggleShow:function(){return this.each(function(){if(b(this).rsfSlideshow("isRunning")){b(this).rsfSlideshow("stopShow")}else{b(this).rsfSlideshow("startShow",false,true)}})},isRunning:function(){if(this.data("rsf_slideshow").interval_id){return true}return false},currentSlideKey:function(){var d=this.data("rsf_slideshow");return d.this_slide},totalSlides:function(){var d=this.data("rsf_slideshow");return d.slides.length},getSlidesFromMarkup:function(d){return this.each(function(){var g=b(this).data("rsf_slideshow");if(!d){d={}}if(!d.data_container){d.data_container=g.settings.data_container}var e;if(d.data_container.charAt(0)==="#"){e=b(d.data_container)}else{e=b(this).children(d.data_container)}if(!e.length){return false}if(!d.slide_data_container){d.slide_data_container=g.settings.slide_data_container}var f=b.extend(true,{},g.settings.slide_data_selectors);if(d.slide_data_selectors){b.extend(true,f,d.slide_data_selectors)}d.slide_data_selectors=f;var h=b(this);e.children(d.slide_data_container).each(function(){var i=c._findData(b(this),d.slide_data_selectors);h.rsfSlideshow("addSlides",i)})})},nextSlide:function(){return this.each(function(){var d=b(this).data("rsf_slideshow");d.this_slide++;if(d.this_slide>=d.slides.length){if(d.settings.loop){d.this_slide=0}else{d.this_slide=d.slides.length-1;b(this).rsfSlideshow("stopShow");return true}}b(this).rsfSlideshow("showSlide",d.slides[d.this_slide])})},previousSlide:function(){return this.each(function(){var d=b(this).data("rsf_slideshow");d.this_slide--;if(d.this_slide<0){if(d.settings.loop){d.this_slide=d.slides.length-1}else{d.this_slide=0;b(this).rsfSlideshow("stopShow");return true}}b(this).rsfSlideshow("showSlide",d.slides[d.this_slide])})},goToSlide:function(d){return this.each(function(){var e=b(this).data("rsf_slideshow");if(typeof e.slides[d]==="object"){e.this_slide=d;b(this).rsfSlideshow("showSlide",e.slides[e.this_slide])}})},showSlide:function(d){var e=this,j=e.data("rsf_slideshow"),i=e.width(),h=e.height();c._trigger(e,"rsPreTransition");e.children("img:first").css("z-index",0);var f=function(k){var l=b(k);l.addClass("rsf-slideshow-image");var m=function(r,n){c._trigger(e,"rsImageReady");var s=0;var p=0;l.css({left:s});l.css({top:p});if(d.image_title){l.attr("title",d.image_title)}if(d.image_alt){l.attr("alt",d.image_alt)}if(d.link_to){l=b('<a href="'+d.link_to+'"></a>').append(l)}var t=b("<div></div>");t.addClass(j.settings.slide_container_class);t.append(l).css("display","none");if(d.caption){var o=b("<div>"+d.caption+"</div>");o.addClass(j.settings.slide_caption_class);o.appendTo(t);if(d.captionClass){o.addClass(d.captionClass)}}var q=j.settings.effect;if(d.effect){q=d.effect}c._trigger(e,"_rsSlideReady",{$slide:t});c._trigger(e,"rsSlideReady",{$slide:t});c._transitionWith(e,t,q);return true};c._getImageDimensions(e,l,m,(j.settings.interval*1000)/2,function(){m()})};var g=new Image();b(g).bind("load",function(){f(this)});g.src=d.url;return this},addControl:function(d){return this.each(function(){var e=b(this),h=e.data("rsf_slideshow").settings;var g=h.controls[d].generate(e);c._controlsContainer(e);h.controls[d].place(e,g);var f="bind"+d.substr(0,1).toUpperCase()+d.substr(1,d.length);e.rsfSlideshow(f,g)})},bindPlayPause:function(d){return this.each(function(){var e=b(this);var f=e.data("rsf_slideshow");d.bind("click.rsfSlideshow",function(g){g.preventDefault();e.rsfSlideshow("toggleShow")})})},bindPreviousSlide:function(d,e){return this.each(function(){var f=b(this);var g=f.data("rsf_slideshow");if(!e){e=g.settings.controls.previousSlide.autostop}d.bind("click.rsfSlideshow",function(h){h.preventDefault();f.rsfSlideshow("previousSlide");if(e){f.rsfSlideshow("stopShow")}})})},bindNextSlide:function(d,e){return this.each(function(){var f=b(this);var g=f.data("rsf_slideshow");if(!e){e=g.settings.controls.nextSlide.autostop}d.bind("click.rsfSlideshow",function(h){h.preventDefault();f.rsfSlideshow("nextSlide");if(e){f.rsfSlideshow("stopShow")}})})},bindIndex:function(d,e){return this.each(function(){var f=b(this),h=f.data("rsf_slideshow").settings;if(!e){e=h.controls.index.autostop}var g=h.controls.index.getEach(f);g.bind("click.rsfSlideshow",function(j){j.preventDefault();var i=h.controls.index.getSlideKey(b(this));if(i){f.rsfSlideshow("goToSlide",i);if(e){f.rsfSlideshow("stopShow")}}});c._bindActiveIndex(f)})}};b.fn.rsfSlideshow=function(d){if(!this.length){return this}if(a[d]){return a[d].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof d==="object"||!d){return a.init.apply(this,arguments)}else{b.error("Method "+d+" does not exist on jQuery.rsfSlidehow")}}};var c={_findData:function(g,f){var d={};var i;for(var e in f){if(f.hasOwnProperty(e)){var h=g.clone();if(f[e].selector){h=h.children(f[e].selector)}if(f[e].attr){i=h.attr(f[e].attr)}else{i=h.html()}d[e]=i}}return d},_addSlide:function(e,d){var h=e.data("rsf_slideshow");if(typeof d==="string"){var f=b.trim(d);h.slides.push({url:f})}else{if(d.url){for(var g in d){if(d.hasOwnProperty(g)){d[g]=b.trim(d[g])}}h.slides.push(d)}}},_removeSlide:function(d,e){d.data("rsf_slideshow").slides.splice(e,1)},_transitionWith:function(d,h,f){var g=d.data("rsf_slideshow"),e="random",i=d.find("."+g.settings.slide_container_class+":last");if(i.length){h.insertAfter(i)}else{h.prependTo(d)}if(typeof f==="object"&&f.iteration&&f.effects){e=f.iteration;f=f.effects}if(f instanceof Array){switch(e){case"loop":g.effect_iterator.this_effect++;if(g.effect_iterator.this_effect>f.length-1){g.effect_iterator.this_effect=0}break;case"backAndForth":g.effect_iterator.this_effect+=g.effect_iterator.direction;if(g.effect_iterator.this_effect<0){g.effect_iterator.this_effect=1;g.effect_iterator.direction=g.effect_iterator.direction*-1}if(g.effect_iterator.this_effect>f.length-1){g.effect_iterator.this_effect=f.length-2;g.effect_iterator.direction=g.effect_iterator.direction*-1}break;default:g.effect_iterator.this_effect=Math.floor(Math.random()*f.length);break}f=f[g.effect_iterator.this_effect]}if(b.rsfSlideshow.transitions[f]&&typeof(b.rsfSlideshow.transitions[f])==="function"){b.rsfSlideshow.transitions[f](d,h)}},_doSlide:function(f,h,e,d){var g=f.data("rsf_slideshow"),i=h.prev();h.css({top:d,left:e});h.css("display","block");h.stop().animate({top:0,left:0},g.settings.transition,g.settings.easing,function(){c._endTransition(f,h)});i.stop().animate({top:(0-d),left:(0-e)},g.settings.transition,g.settings.easing)},_getImageDimensions:function(e,g,f,i,k,j){if(!j){j=0;e.prepend(g)}var h=g.outerWidth();var d=g.outerHeight();if(h&&d){g.detach();f(h,d);return true}if(i&&j>i){g.detach();if(k&&typeof(k)==="function"){k(i,j)}return false}j+=200;setTimeout(function(){c._getImageDimensions(e,g,f,i,k,j)},200)},_endTransition:function(d,e){e.prev().remove();c._trigger(d,"rsPostTransition");if(d.rsfSlideshow("currentSlideKey")===d.rsfSlideshow("totalSlides")-1){c._trigger(d,"rsLastSlide")}else{if(d.rsfSlideshow("currentSlideKey")===0){c._trigger(d,"rsFirstSlide")}}},_bindActiveIndex:function(d){var e=d.data("rsf_slideshow").settings.controls.index;d.bind("rsPreTransition",function(){var f=b(this).rsfSlideshow("currentSlideKey");e.getEach(d).removeClass(e.active_class);e.getSingleByKey(d,f).addClass(e.active_class)})},_controlsContainer:function(d){var e=d.data("rsf_slideshow").settings;if(!e.controls.container.get(d).length){var f=e.controls.container.generate(d);e.controls.container.place(d,f)}},_trigger:function(f,h,d){var g=f.data("rsf_slideshow");if(typeof d!=="object"){d={}}b.extend(d,{slide_key:g.this_slide,slide:g.slides[g.this_slide]});f.trigger(h,d)},_setTimeout:function(d,e){var f=d.data("rsf_slideshow");if(f.interval_id){clearTimeout(f.interval_id)}if(!e){e=f.settings.interval}if(e<=f.settings.transition/1000){e=(f.settings.transition/1000)+0.1}f.interval_id=setTimeout(function(){d.rsfSlideshow("nextSlide")},e*1000)}};b.rsfSlideshow={defaults:{interval:5,transition:1000,effect:"fade",easing:"swing",loop:true,autostart:true,slides:[],slide_container_class:"slide-container",slide_caption_class:"slide-caption",data_container:"ol.slides",slide_data_container:"li",slide_data_selectors:{url:{selector:"a",attr:"href"},caption:{selector:"a",attr:"title"},link_to:{selector:"a",attr:"data-link-to"},effect:{selector:"a",attr:"data-effect"}},eventHandlers:{rsStartShow:function(g,h){var d=b(g).data("rsf_slideshow").settings.controls.playPause;var f=d.get(b(g));f.html("Pause").addClass(d.playing_class)},rsStopShow:function(g,h){var d=b(g).data("rsf_slideshow").settings.controls.playPause;var f=d.get(b(g));f.html("Play").addClass(d.paused_class)}},controls:{playPause:{generate:function(d){return b('<a href="#" class="rs-play-pause '+d.data("rsf_slideshow").settings.controls.playPause.paused_class+'" data-control-for="'+d.attr("id")+'">Play</a>')},place:function(d,e){var f=d.data("rsf_slideshow").settings.controls.container.get(d);f.append(e)},get:function(d){return b('.rs-play-pause[data-control-for="'+d.attr("id")+'"]')},playing_class:"rs-playing",paused_class:"rs-paused",auto:false},previousSlide:{generate:function(d){return b('<a href="#" class="rs-prev" data-control-for="'+d.attr("id")+'">&lt;</a>')},place:function(d,e){var f=d.data("rsf_slideshow").settings.controls.container.get(d);f.append(e)},get:function(d){return b('.rs-prev[data-control-for="'+d.attr("id")+'"]')},autostop:true,auto:false},nextSlide:{generate:function(d){return b('<a href="#" class="rs-next" data-control-for="'+d.attr("id")+'">&gt;</a>')},place:function(d,e){var f=d.data("rsf_slideshow").settings.controls.container.get(d);f.append(e)},get:function(d){return b('.rs-next[data-control-for="'+d.attr("id")+'"]')},autostop:true,auto:false},index:{generate:function(e){var h=e.rsfSlideshow("totalSlides"),d=b('<ul class="rs-index-list clearfix"></ul>');d.attr("data-control-for",e.attr("id"));for(var g=0;g<h;g++){var f=b('<a href="#"></a>');f.addClass("rs-index");f.attr("data-control-for",e.attr("id"));f.attr("data-slide-key",g);f.append(g+1);if(g===e.rsfSlideshow("currentSlideKey")){f.addClass("rs-active")}var j=b("<li></li>");j.append(f);d.append(j)}return d},place:function(d,e){var f=d.data("rsf_slideshow").settings.controls.container.get(d);f.append(e)},get:function(d){return b('.rs-index-list[data-control-for="'+d.attr("id")+'"]')},getEach:function(d){return b('.rs-index[data-control-for="'+d.attr("id")+'"]')},getSingleByKey:function(d,e){return b('.rs-index[data-control-for="'+d.attr("id")+'"][data-slide-key="'+e+'"]')},getSlideKey:function(d){return d.attr("data-slide-key")},active_class:"rs-active",autostop:true,auto:false},container:{generate:function(d){return b('<div class="rs-controls clearfix" id="rs-controls-'+d.attr("id")+'"></div>')},place:function(d,e){d.after(e)},get:function(d){return b("#rs-controls-"+d.attr("id"))}}}},transitions:{none:function(d,e){e.css("display","block")},fade:function(d,e){e.fadeIn(d.data("rsf_slideshow").settings.transition,function(){c._endTransition(d,e)})},slideLeft:function(e,f){var d=f.outerWidth();c._doSlide(e,f,d,0)},slideRight:function(e,f){var d=0-f.outerWidth();c._doSlide(e,f,d,0)},slideUp:function(e,f){var d=f.outerHeight();c._doSlide(e,f,0,d)},slideDown:function(e,f){var d=0-f.outerHeight();c._doSlide(e,f,0,d)}}}})(jQuery);